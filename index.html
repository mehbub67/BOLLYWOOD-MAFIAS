<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>BOLLYWOOD MAFIA</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:#000;color:#fff;overflow:hidden}

/* SCREENS */
.screen{position:absolute;inset:0;display:none}
.screen.active{display:flex}

/* MENU */
#menu{
  background:url('menu/menu_bg.jpg') center/cover no-repeat;
  justify-content:center;
  align-items:center;
}
.menu-box{
  background:rgba(0,0,0,.75);
  padding:20px;
  border-radius:16px;
  width:90%;
  max-width:420px;
  text-align:center;
}
.menu-btn{
  width:100%;
  padding:14px;
  margin-top:12px;
  font-size:18px;
  border-radius:12px;
  border:none;
  background:#e91e63;
  color:#fff;
}

/* GAME */
#game{background:#111}

/* WORLD */
#world{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  width:360px;
  height:100%;
  overflow:hidden;
}

/* ROAD */
#road{
  position:absolute;
  left:80px;
  width:200px;
  height:100%;
  background:url('road/road_city.png') repeat-y center/contain;
}

/* CITY SIDES */
.city{position:absolute;top:0;width:80px;height:100%}
#leftCity{left:0}
#rightCity{right:0}

/* BUILDINGS */
.building{
  position:absolute;
  width:80px;height:120px;
  background-size:cover;
  z-index:1;
}

/* CARS */
.car{
  position:absolute;
  width:48px;height:90px;
  background-size:contain;
  background-repeat:no-repeat;
  z-index:5;
}

/* NPC HUMAN */
.human{
  position:absolute;
  width:32px;
  height:48px;
  background-image:url('sprites/npc/npc_topdown_walk.png');
  background-repeat:no-repeat;
  background-size:128px 192px; /* 4x4 grid */
  z-index:3;
}

/* PLAYER */
#player{bottom:120px;z-index:6}

/* HUD */
#hud{
  position:absolute;
  top:8px;left:8px;right:8px;
  display:flex;
  justify-content:space-between;
  font-size:14px;
  z-index:10;
}
#wanted{color:gold}

/* MISSION */
#mission{
  position:absolute;
  top:36px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.6);
  padding:6px 12px;
  border-radius:8px;
  font-size:13px;
  z-index:10;
}

/* CONTROLS */
#controls{
  position:absolute;
  bottom:0;left:0;right:0;
  height:110px;
  display:flex;
  justify-content:space-around;
  align-items:center;
  background:linear-gradient(#222,#000);
  z-index:10;
}
.ctrl{
  width:72px;height:72px;
  border-radius:50%;
  background:radial-gradient(circle,#555,#111);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:24px;
}
#nitro{background:radial-gradient(circle,#ffd700,#b8860b);color:#000}
</style>
</head>

<body>

<!-- AUDIO -->
<audio id="menuMusic" src="sounds/menu_music.mp3" loop></audio>
<audio id="engineSound" src="sounds/engine.mp3" loop></audio>
<audio id="nitroSound" src="sounds/nitro.mp3"></audio>
<audio id="crashSound" src="sounds/crash.mp3"></audio>

<!-- MENU -->
<div id="menu" class="screen active">
  <div class="menu-box">
    <h1>BOLLYWOOD MAFIA</h1>
    <p>Coins: <span id="mCoins">0</span></p>
    <button class="menu-btn" onclick="startGame()">START</button>
  </div>
</div>

<!-- GAME -->
<div id="game" class="screen">
  <div id="world">
    <div id="leftCity" class="city"></div>
    <div id="rightCity" class="city"></div>
    <div id="road"></div>
    <div id="player" class="car"></div>
  </div>

  <div id="hud">
    <div>HP: <span id="hp">100</span></div>
    <div id="wanted">☆☆☆☆☆</div>
    <div>Coins: <span id="coins">0</span></div>
  </div>

  <div id="mission">Mission: Drive 500m</div>

  <div id="controls">
    <div class="ctrl" id="leftBtn">◀</div>
    <div class="ctrl" id="nitro">N</div>
    <div class="ctrl" id="rightBtn">▶</div>
  </div>
</div>

<script>
let coins=0,hp=100,wanted=0;
let speed=4,dir=0;
let x=160;
let frame=0,frameTick=0;

const lanes=[100,160,220];
player.style.backgroundImage="url('cars/player_red.png')";
player.style.left=x+"px";

/* START */
function startGame(){
  menu.classList.remove("active");
  game.classList.add("active");
  menuMusic.play();
  engineSound.play();
  setInterval(spawnHuman,2000);
  setInterval(spawnNPC,1600);
  setInterval(spawnPolice,3500);
  requestAnimationFrame(loop);
}

/* CONTROLS */
leftBtn.ontouchstart=()=>dir=-1;
rightBtn.ontouchstart=()=>dir=1;
leftBtn.ontouchend=rightBtn.ontouchend=()=>dir=0;
nitro.ontouchstart=()=>{speed=7;nitroSound.play()}
nitro.ontouchend=()=>speed=4;

/* NPC HUMAN */
const humans=[];
function spawnHuman(){
  let h=document.createElement("div");
  h.className="human";
  h.style.left=Math.random()<.5?"20px":"300px";
  h.style.top="-50px";
  h.dataset.frame=0;
  world.appendChild(h);
  humans.push(h);
}

/* NPC CARS */
const npcs=[],police=[];
function spawnNPC(){
  let c=document.createElement("div");
  c.className="car";
  c.style.backgroundImage="url('cars/npc_car.png')";
  c.style.left=lanes[Math.floor(Math.random()*3)]+"px";
  c.style.top="-120px";
  world.appendChild(c);
  npcs.push(c);
}

/* POLICE */
function spawnPolice(){
  if(wanted<1)return;
  let p=document.createElement("div");
  p.className="car";
  p.style.backgroundImage="url('cars/police.png')";
  p.style.left=lanes[Math.floor(Math.random()*3)]+"px";
  p.style.top="-180px";
  world.appendChild(p);
  police.push(p);
}

/* LOOP */
function loop(){
  x+=dir*speed;
  if(x<lanes[0])x=lanes[0];
  if(x>lanes[2])x=lanes[2];
  player.style.left=x+"px";

  frameTick++;
  if(frameTick%8===0)frame=(frame+1)%4;

  humans.forEach((h,i)=>{
    h.style.top=h.offsetTop+1+"px";
    h.style.backgroundPosition=`-${frame*32}px 0px`; // DOWN row
    if(h.offsetTop>window.innerHeight){h.remove();humans.splice(i,1)}
  });

  npcs.forEach((c,i)=>{
    c.style.top=c.offsetTop+4+"px";
    if(c.offsetTop>window.innerHeight){c.remove();npcs.splice(i,1)}
  });

  police.forEach(p=>{
    p.style.top=p.offsetTop+5+"px";
    p.style.left=p.offsetLeft+(x-p.offsetLeft)*0.04+"px";
  });

  requestAnimationFrame(loop);
}
</script>

</body>
</html>
