<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>BOLLYWOOD MAFIA</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:#000;color:#fff;overflow:hidden}

/* SCREENS */
.screen{position:absolute;inset:0;display:none}
.screen.active{display:flex}

/* MENU */
#menu{
  background:url('menu/menu_bg.jpg') center/cover no-repeat;
  justify-content:center;
  align-items:center;
}
.menu-box{
  background:rgba(0,0,0,.75);
  padding:20px;
  border-radius:16px;
  width:90%;
  max-width:420px;
  text-align:center;
}
.menu-btn{
  width:100%;
  padding:14px;
  margin-top:12px;
  font-size:18px;
  border-radius:12px;
  border:none;
  background:#e91e63;
  color:#fff;
}

/* GAME */
#game{background:#111}

/* WORLD */
#world{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  width:360px;
  height:100%;
  overflow:hidden;
}

/* ROAD */
#road{
  position:absolute;
  left:80px;
  width:200px;
  height:100%;
  background:url('road/road_city.png') repeat-y center/contain;
}

/* OUTSIDE WORLD */
.side{
  position:absolute;
  top:0;
  width:80px;
  height:100%;
  background:#222;
}
#leftSide{left:0}
#rightSide{right:0}

/* ENTITIES */
.car{
  position:absolute;
  width:48px;
  height:90px;
  background-size:contain;
  background-repeat:no-repeat;
}
.human{
  position:absolute;
  width:36px;
  height:36px;
  background:url('humans/npc_human.png') center/contain no-repeat;
}

/* PLAYER */
#player{bottom:120px}

/* HUD */
#hud{
  position:absolute;
  top:8px;
  left:8px;
  right:8px;
  display:flex;
  justify-content:space-between;
  font-size:14px;
}
#wanted{color:gold}

/* MISSION */
#mission{
  position:absolute;
  top:36px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.6);
  padding:6px 12px;
  border-radius:8px;
  font-size:13px;
}

/* CONTROLS */
#controls{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  height:110px;
  display:flex;
  justify-content:space-around;
  align-items:center;
  background:linear-gradient(#222,#000);
}
.ctrl{
  width:72px;
  height:72px;
  border-radius:50%;
  background:radial-gradient(circle,#555,#111);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:24px;
  user-select:none;
}
#nitro{
  background:radial-gradient(circle,#ffd700,#b8860b);
  color:#000;
}
</style>
</head>

<body>

<!-- AUDIO -->
<audio id="menuMusic" src="sounds/menu_music.mp3" loop></audio>
<audio id="engineSound" src="sounds/engine.mp3" loop></audio>
<audio id="nitroSound" src="sounds/nitro.mp3"></audio>
<audio id="crashSound" src="sounds/crash.mp3"></audio>

<!-- MENU -->
<div id="menu" class="screen active">
  <div class="menu-box">
    <h1>BOLLYWOOD MAFIA</h1>
    <p>Coins: <span id="mCoins">0</span></p>
    <button class="menu-btn" onclick="startGame()">START</button>
  </div>
</div>

<!-- GAME -->
<div id="game" class="screen">
  <div id="world">
    <div id="leftSide" class="side"></div>
    <div id="rightSide" class="side"></div>
    <div id="road"></div>
    <div id="player" class="car"></div>
  </div>

  <div id="hud">
    <div>HP: <span id="hp">100</span></div>
    <div id="wanted">☆☆☆☆☆</div>
    <div>Coins: <span id="coins">0</span></div>
  </div>

  <div id="mission"></div>

  <div id="controls">
    <div class="ctrl" id="leftBtn">◀</div>
    <div class="ctrl" id="nitro">N</div>
    <div class="ctrl" id="rightBtn">▶</div>
  </div>
</div>

<script>
/* STATE */
let roadLeft=80;
let roadRight=80+200-48;
let x=roadLeft+80;
let moveDir=0;
let coins=0,hp=100,wanted=0,score=0;
let npcs=[],humans=[],police=[];
let run=false;

/* ELEMENTS */
const player=document.getElementById("player");
player.style.backgroundImage="url('cars/player_red.png')";

/* MENU */
function startGame(){
  document.getElementById("menu").classList.remove("active");
  document.getElementById("game").classList.add("active");

  menuMusic.play();
  engineSound.play();

  run=true;
  mission.textContent="Mission: Drive 500m";

  setInterval(spawnNPC,1500);
  setInterval(spawnHuman,2200);
  setInterval(gameLoop,16);
}

/* CONTROLS (HOLD TO MOVE) */
leftBtn.ontouchstart=()=>moveDir=-1;
rightBtn.ontouchstart=()=>moveDir=1;
leftBtn.ontouchend=()=>moveDir=0;
rightBtn.ontouchend=()=>moveDir=0;
nitro.ontouchstart=()=>nitroSound.play();

/* SPAWN */
function spawnNPC(){
  let c=document.createElement("div");
  c.className="car";
  c.style.backgroundImage="url('cars/npc_car.png')";
  c.style.left=roadLeft+Math.random()*(roadRight-roadLeft)+"px";
  c.style.top="-100px";
  world.appendChild(c);
  npcs.push(c);
}
function spawnHuman(){
  let h=document.createElement("div");
  h.className="human";
  h.style.left=Math.random()<.5?"20px":"300px";
  h.style.top="100%";
  world.appendChild(h);
  humans.push(h);
}

/* COLLISION */
function hit(a,b){
  let r1=a.getBoundingClientRect();
  let r2=b.getBoundingClientRect();
  return !(r1.bottom<r2.top||r1.top>r2.bottom||
           r1.right<r2.left||r1.left>r2.right);
}

/* LOOP */
function gameLoop(){
  if(!run)return;

  x+=moveDir*4;
  if(x<roadLeft)x=roadLeft;
  if(x>roadRight)x=roadRight;
  player.style.left=x+"px";

  npcs.forEach((c,i)=>{
    c.style.top=c.offsetTop+4+"px";
    if(hit(player,c)){crashSound.play();c.remove();npcs.splice(i,1)}
  });

  humans.forEach((h,i)=>{
    h.style.top=h.offsetTop-2+"px";
    if(h.offsetTop<-40){h.remove();humans.splice(i,1)}
  });
}
</script>

</body>
</html>
